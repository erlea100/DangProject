<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
  
  <mapper namespace="costMapper">
  <update id="insertDiary" parameterType="cost">
 <!--  INSERT INTO 
  COST (ID, A_FEED , A_SNACK , B_DIAGNOSIS , B_VACCIN , C_GROOMING ,C_CLOTHES , D_NUTRIENTS , D_POO , E_TRAINNING , E_HOTEL , E_KINDERGARTEN , SUBMIT_DATE)
  VALUES( #{id}, #{a_Feed} , #{a_Snack}, #{b_Diagnosis}, #{b_Vaccin}, #{c_Grooming}, #{c_Clothes}, #{d_Nutrients}, #{d_Poo}, #{e_Trainning}, #{e_Hotel}, #{e_Kindergarten} , TO_DATE(#{date},'YYYY-MM-DD'))  -->
  	
  	MERGE INTO COST 
    USING DUAL
    ON ( ID = #{id} AND SUBMIT_DATE = #{date} )
    WHEN MATCHED THEN
    UPDATE SET A_FEED = A_FEED + #{a_Feed} ,  A_SNACK =   A_SNACK +#{a_Snack}  , B_DIAGNOSIS = B_DIAGNOSIS + #{b_Diagnosis} , B_VACCIN = B_VACCIN + #{b_Vaccin} , C_GROOMING = C_GROOMING + #{c_Grooming} , C_CLOTHES = C_CLOTHES + #{c_Clothes} , D_NUTRIENTS = D_NUTRIENTS + #{d_Nutrients} , D_POO = D_POO + #{d_Poo} , E_TRAINNING = E_TRAINNING + #{e_Trainning} , E_HOTEL = E_HOTEL + #{e_Hotel} , E_KINDERGARTEN = E_KINDERGARTEN + #{e_Kindergarten}
    WHEN NOT MATCHED THEN
    INSERT(ID , A_FEED , A_SNACK , B_DIAGNOSIS , B_VACCIN , C_GROOMING ,C_CLOTHES , D_NUTRIENTS , D_POO , E_TRAINNING , E_HOTEL , E_KINDERGARTEN , SUBMIT_DATE , DIARY_DAY , DIARY_MONTH , DIARY_YEAR ) 
    VALUES(#{id}, #{a_Feed} , #{a_Snack} , #{b_Diagnosis} , #{b_Vaccin} , #{c_Grooming} , #{c_Clothes} , #{d_Nutrients} , #{d_Poo} , #{e_Trainning} , #{e_Hotel} , #{e_Kindergarten} , #{date} , #{diary_day} , #{diary_month} , #{diary_year} ) 
  	
  	</update>
  	
 <select id="selectDiary" parameterType="cost" resultType="cost">
 	<!-- SELECT SUM(A_FEED) , SUM(A_SNACK) , SUM(B_DIAGNOSIS) , SUM(B_VACCIN) , SUM(C_CLOTHES) , SUM(C_GROOMING) , SUM(D_NUTRIENTS) , SUM(D_POO) , SUM(E_TRAINNING) , SUM(E_HOTEL) , SUM(E_KINDERGARTEN) -->
	<!-- SELECT  SUM(A_FEED) , NVL(SUM(A_SNACK),0) , NVL(SUM(B_DIAGNOSIS),0) , NVL(SUM(B_VACCIN),0) , NVL(SUM(C_CLOTHES),0) , NVL(SUM(C_GROOMING),0) , NVL(SUM(D_NUTRIENTS),0) , NVL(SUM(D_POO),0) , NVL(SUM(E_TRAINNING),0) , NVL(SUM(E_HOTEL),0) , NVL(SUM(E_KINDERGARTEN),0) -->
	
	<!-- SELECT A_FEED , A_SNACK , B_DIAGNOSIS , B_VACCIN , C_CLOTHES , C_GROOMING , D_NUTRIENTS , D_POO , E_TRAINNING , E_HOTEL , E_KINDERGARTEN
	FROM COST 
 	WHERE  SUBMIT_DATE = TO_DATE(#{date},'YYYY-MM-DD') AND ID = #{id}  
 	AND (A_FEED !=0 OR A_SNACK !=0 OR B_DIAGNOSIS!=0 OR B_VACCIN!= 0 OR C_CLOTHES!=0 OR C_GROOMING !=0 OR D_NUTRIENTS !=0 OR D_POO !=0 OR E_TRAINNING !=0 OR E_HOTEL !=0 OR E_KINDERGARTEN !=0) -->

<!-- 	SELECT * -->
<!-- 	FROM COST -->
<!-- 	WHERE ID = #{id} AND SUBMIT_DATE = #{date}  -->


SELECT * FROM COST
WHERE id = #{id} AND SUBMIT_DATE= #{date} 

 </select>
 
 <select id="icon_selectDiary" parameterType="cost" resultType="cost">
	SELECT
	*
	FROM
	COST
	WHERE
	id = #{id}
	AND
	SUBMIT_DATE= #{date} 
	<!-- GROUP BY SUBMIT_DATE
	ORDER BY SUBMIT_DATE -->
 </select>
 
  </mapper>
  
  
 